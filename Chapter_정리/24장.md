# 24. 클로저

클로저는 자바스크립트 고유의 개념이 아니므로 클로저의 정의가 ECMAScript 사양에 등장하지 않음

```
클로저는 함수와 그 함수가 선언된 렉시컬 환경과의 조합이다.
```

위 정의를 이해하기 위해서 `함수가 선언된 렉시컬 환경`이 핵심 키워드임

```js
const x = 1;

function outerFunc() {
  const x = 10;

  function innerFunc() {
    console.log(x); // 10
  }

  innerFunc();
}

outerFunc();
```

중첩 함수 innerFunc의 상위 스코프는 외부 함수 outerFunc의 스코프임

따라서 innerFunc 내부에서 자신을 포함하고 있는 외부 함수 outerFunc의 x 변수에 접근할 수 있음

> 자바스크립트는 렉시컬 스코프를 따르는 프로그래밍 언어임

## 24.1. 렉시컬 스코프

- 렉시컬 스코프(정적 스코프): 렉시컬 환경의 "외부 렉시컬 환경에 대한 참조"에 저장할 참조값,

  즉 상위 스코프에 대한 참조는 함수 정의가 평가되는 시점에 함수가 정의돈 환경(위치)에 의해 결정됨

  > 함수를 어디서 호출하는지는 함수의 상위 스코프 결정에 어떠한 영향도 주지 못함

- 스코프 체인: 렉시컬 환경은 자신의 "외부 렉시컬 환경에 대한 참조"를 통해 상위 렉시컬 환경과 연결됨

  > 스코프의 실체는 실행 컨텍스트의 렉시컬 환경

## 24.2. 함수 객체의 내부 슬록[[Environment]]

함수는 자신의 내부 슬롯[[Environment]]에 자신이 정의된 환경, 즉 상위 스코프 참조를 저장

- 상위 스코프: 함수 객체의 내부 슬롯[[Environment]]에 저장된 현재 실행 중인 실행 컨텍스트의 렉시컬 환경의 참조가 바로 상위 스코프임

- 참조값: 자신이 호출되었을 때 생성될 함수 렉시컬 환경의 "외부 렉시컬 환경에 대한 참조"에 저장될 값

> 함수 객체는 내부 슬롯[[Environment]]에 저장한 렉시컬 환경의 참조, 즉 상위 스코프를 자신이 존재하는 한 기억함

```js
const x = 1;

function foo() {
  const x = 10;

  bar();
}

function bar() {
  console.log(x);
}

foo(); // 1
bar(); // 1
```

생성된 함수 객체의 내부 슬롯 [[Environment]]에는 함수 정의가 평가된 시점, 즉 전역 코드 평가 시점에 실행 중인 실행 컨텍스트의 렉시컬 환경인 전역 렉시컬 환경의 참조가 저장됨

> 외부 렉시컬 환경에 대한 참조에는 함수 객체의 내부 슬롯 [[Environment]]에 저장된 렉시컬 환경의 참조가 할당됨

## 24.3. 클로저와 렉시컬 환경

클로저: 중첩 함수가 상위 스코프의 식별자를 참조하고 있고 중첩 함수가 외부 함수보다 더 오래 유지되는 경우에 한정하느 ㄴ것이 일반 적

- 중첩 함수 내부에서 상위 스코프 참조 가능
- 상위 스코프의 식별자 참조 가능
- 식별자의 값 변경 가능

자유 변수: 클로저에 의해 참조되는 상위 스코프의 변수

> 자바스크립트 엔진은 최적화가 잘 되어 있어서 클로저가 참조하고 있지 않는 식별자는 기억하지 않음

## 24.4 클로저의 활용

- 클로저는 상태를 안전하게 변경하고 유지하기 위해 사용함

  - 상태를 안전하게 은닉

  ```js
  //  예제 24-11
  const increase = (function () {
    // 카운트 상태 변수
    let num = 0;
    //  클로저
    return function () {
      //  카운트 상태를 1만큼 증가시킨다.
      return ++num;
    };
  })();

  console.log(increase()); // 1
  console.log(increase()); // 2
  ```

  > 여기에 은닉의 예제 코드가 많은데
  >
  > 이해하기에 다소 어려움
  >
  > 다시 복습하기 바람

  - 특정 함수에게만 상태 변경을 허용

## 24.5 캡슐화와 정보 은닉

캡슐화

- 객체의 상태를 나타내는 프로퍼티와 프로퍼티를 참조하고 조작할 수 있는 동작인 메서드를 하나로 묶는 것
- **객체의 특정 프로퍼티나 메서드를 감출 목적으로 사용**
  - 객체 간의 결합도를 낮추는 것
  -
